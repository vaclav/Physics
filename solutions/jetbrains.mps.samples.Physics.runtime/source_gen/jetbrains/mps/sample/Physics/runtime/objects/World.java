package jetbrains.mps.sample.Physics.runtime.objects;

/*Generated by MPS */

import org.ode4j.ode.DWorld;
import org.ode4j.ode.DSpace;
import java.util.ArrayList;
import org.ode4j.ode.OdeHelper;
import processing.core.PApplet;
import java.util.List;

public class World {
  private DWorld world;
  private DSpace space;
  private ArrayList<PhysicalEntity> entities = new ArrayList();
  public World() {
    this.world = OdeHelper.createWorld();
    this.space = OdeHelper.createHashSpace();
  }
  /**
   * Perform a simulation step
   */
  public void step() {
    // TODO handle collisions with space.collide(null, null); 
    for (PhysicalEntity entity : entities) {
      entity.applyForces();
    }
    world.quickStep(6);
  }
  /**
   * Render the world
   * @param ctx applet context
   */
  public void render(PApplet ctx) {
    for (PhysicalEntity entity : entities) {
      entity.render(ctx);
    }
  }
  public void addEntity(PhysicalEntity entity) {
    entities.add(entity);
  }
  public DSpace getSpace() {
    return space;
  }
  public DWorld getWorld() {
    return world;
  }
  public List<PhysicalEntity> getEntities() {
    return entities;
  }
}
