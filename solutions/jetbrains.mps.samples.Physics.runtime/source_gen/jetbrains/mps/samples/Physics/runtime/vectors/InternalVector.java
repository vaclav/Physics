package jetbrains.mps.samples.Physics.runtime.vectors;

/*Generated by MPS */

import java.math.MathContext;
import java.math.BigDecimal;
import org.ode4j.math.DVector3C;
import org.ode4j.math.DVector3;
import java.math.RoundingMode;

public class InternalVector {
  private static final MathContext ctx = MathContext.DECIMAL128;
  private BigDecimal x;
  private BigDecimal y;
  private BigDecimal z;

  public InternalVector(BigDecimal x, BigDecimal y, BigDecimal z) {
    this.x = x;
    this.y = y;
    this.z = z;
  }
  public InternalVector(Number x, Number y, Number z) {
    this(BigDecimal.valueOf(x.doubleValue()), BigDecimal.valueOf(y.doubleValue()), BigDecimal.valueOf(z.doubleValue()));
  }


  public InternalVector toUnit() {
    BigDecimal length = length();
    return new InternalVector(getX().divide(length, ctx), getY().divide(length, ctx), getZ().divide(length, ctx));
  }
  public InternalVector add(InternalVector v) {
    return new InternalVector(getX().add(v.getX(), ctx), getY().add(v.getY(), ctx), getZ().add(v.getZ(), ctx));
  }
  public InternalVector minus(InternalVector v) {
    return new InternalVector(getX().subtract(v.getX(), ctx), getY().subtract(v.getY(), ctx), getZ().subtract(v.getZ(), ctx));
  }
  public InternalVector mul(BigDecimal factor) {
    return new InternalVector(getX().multiply(factor, ctx), getY().multiply(factor, ctx), getZ().multiply(factor, ctx));
  }
  public InternalVector resize(BigDecimal newLength) {
    InternalVector unit = this.mul(BigDecimal.ONE.divide(length(), ctx));
    return (BigDecimal.ONE.equals(newLength) ? unit : unit.mul(newLength));
  }

  public BigDecimal lengthSquared() {
    return getX().pow(2, ctx).add(getY().pow(2, ctx), ctx).add(getZ().pow(2, ctx), ctx);
  }

  public BigDecimal length() {
    return lengthSquared().sqrt(ctx);
  }

  /**
   * Compute and returns the polar angle (theta / θ)
   * 
   * @return polar angle
   */
  public BigDecimal getPolarAngle() {
    double acos = Math.acos(getZ().divide(length(), ctx).doubleValue());
    return BigDecimal.valueOf(acos);
  }

  /**
   * Compute and returns the azimuthal angle (phi / φ)
   * 
   * @return azimutal angle
   */
  public BigDecimal getAzimutalAngle() {
    double atan = Math.atan(getY().divide(getX()).doubleValue());
    return BigDecimal.valueOf(atan);
  }

  public static InternalVector fromSpherical(Number length, Number theta, Number phi) {
    return fromSpherical(BigDecimal.valueOf(length.doubleValue()), BigDecimal.valueOf(theta.doubleValue()), BigDecimal.valueOf(phi.doubleValue()));
  }

  /**
   * Get an internal vector from spherical coordinates
   */
  public static InternalVector fromSpherical(BigDecimal length, BigDecimal theta, BigDecimal phi) {
    double thetaDouble = theta.doubleValue();
    double phiDouble = phi.doubleValue();
    BigDecimal sinTheta = BigDecimal.valueOf(Math.sin(thetaDouble));

    return new InternalVector(length.multiply(sinTheta, ctx).multiply(BigDecimal.valueOf(Math.cos(phiDouble)), ctx), length.multiply(sinTheta, ctx).multiply(BigDecimal.valueOf(Math.sin(phiDouble)), ctx), length.multiply(BigDecimal.valueOf(Math.cos(thetaDouble)), ctx));
  }

  public static InternalVector zero() {
    return new InternalVector(BigDecimal.ZERO, BigDecimal.ZERO, BigDecimal.ZERO);
  }


  public DVector3C toDVector3C() {
    return new DVector3(getX().doubleValue(), getY().doubleValue(), getZ().doubleValue());
  }

  public static InternalVector fromDVector3C(DVector3C vec) {
    return new InternalVector(BigDecimal.valueOf(vec.get0()), BigDecimal.valueOf(vec.get1()), BigDecimal.valueOf(vec.get2()));
  }

  @Override
  public String toString() {
    return "[" + "x=" + getX().setScale(2, RoundingMode.HALF_UP) + ", y=" + getY().setScale(2, RoundingMode.HALF_UP) + ", z=" + getZ().setScale(2, RoundingMode.HALF_UP) + "]";
  }


  public BigDecimal getX() {
    return this.x;
  }
  public BigDecimal getY() {
    return this.y;
  }
  public BigDecimal getZ() {
    return this.z;
  }
}
